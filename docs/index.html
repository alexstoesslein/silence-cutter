<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silence Cutter – AI Take Selector</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-container">

        <!-- Header -->
        <header class="app-header">
            <h1>Silence Cutter</h1>
            <p class="subtitle">AI-Powered Take Selector</p>
        </header>

        <!-- ── SCREEN 1: Upload ── -->
        <section id="screen-upload" class="screen active">
            <div class="upload-zone" id="drop-zone">
                <div class="upload-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                </div>
                <p class="upload-text">Datei hierher ziehen oder klicken</p>
                <p class="upload-formats">MP4, MOV, MKV, WAV, MP3, FLAC, M4A, WEBM</p>
                <input type="file" id="file-input" accept=".mp4,.mov,.mkv,.wav,.mp3,.flac,.m4a,.webm" hidden>
            </div>

            <!-- API Key -->
            <div class="api-key-panel">
                <label for="api-key-input">Claude API Key (optional)</label>
                <input type="password" id="api-key-input" placeholder="Standard-Key hinterlegt – eigenen eingeben um zu &uuml;berschreiben" autocomplete="off">
                <p class="api-key-hint">Ein Standard-Key ist hinterlegt. Optional eigenen eingeben.</p>
            </div>

            <!-- Settings -->
            <div class="settings-panel">
                <h3>Einstellungen</h3>
                <div class="settings-grid">
                    <div class="setting">
                        <label for="noise-threshold">Silence Threshold (dB)</label>
                        <input type="range" id="noise-threshold" min="-60" max="-10" value="-35" step="1">
                        <span class="setting-value" id="noise-threshold-val">-35 dB</span>
                    </div>
                    <div class="setting">
                        <label for="min-silence">Min. Stille (s)</label>
                        <input type="range" id="min-silence" min="0.2" max="3.0" value="0.7" step="0.1">
                        <span class="setting-value" id="min-silence-val">0.7s</span>
                    </div>
                    <div class="setting">
                        <label for="min-speech">Min. Take-L&auml;nge (s)</label>
                        <input type="range" id="min-speech" min="0.1" max="2.0" value="0.3" step="0.1">
                        <span class="setting-value" id="min-speech-val">0.3s</span>
                    </div>
                    <div class="setting">
                        <label for="whisper-model">Whisper Modell</label>
                        <select id="whisper-model">
                            <option value="tiny">Tiny (~40 MB, schnell)</option>
                            <option value="base">Base (~75 MB)</option>
                            <option value="small" selected>Small (~250 MB, empfohlen)</option>
                            <option value="medium">Medium (~750 MB, langsam)</option>
                        </select>
                    </div>
                    <div class="setting">
                        <label for="whisper-language">Sprache</label>
                        <select id="whisper-language">
                            <option value="de" selected>Deutsch</option>
                            <option value="en">English</option>
                            <option value="fr">Fran&ccedil;ais</option>
                            <option value="es">Espa&ntilde;ol</option>
                            <option value="it">Italiano</option>
                            <option value="pt">Portugu&ecirc;s</option>
                            <option value="nl">Nederlands</option>
                            <option value="pl">Polski</option>
                            <option value="ru">Русский</option>
                            <option value="ja">日本語</option>
                            <option value="zh">中文</option>
                            <option value="ko">한국어</option>
                            <option value="auto">Auto-Erkennung</option>
                        </select>
                    </div>
                    <div class="setting">
                        <label for="similarity-threshold">&Auml;hnlichkeit f&uuml;r Gruppierung</label>
                        <input type="range" id="similarity-threshold" min="0.3" max="0.9" value="0.6" step="0.05">
                        <span class="setting-value" id="similarity-threshold-val">60%</span>
                    </div>
                    <div class="setting">
                        <label for="fps">FPS (Export)</label>
                        <select id="fps">
                            <option value="24">24</option>
                            <option value="25" selected>25</option>
                            <option value="30">30</option>
                            <option value="50">50</option>
                            <option value="60">60</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- ── SCREEN 2: Processing ── -->
        <section id="screen-processing" class="screen">
            <div class="processing-card">
                <h2 id="processing-filename"></h2>
                <div class="steps-list" id="steps-list">
                    <div class="step" data-step="loading_ffmpeg">
                        <span class="step-icon">1</span>
                        <span class="step-label">FFmpeg.wasm laden</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="silence_detection">
                        <span class="step-icon">2</span>
                        <span class="step-label">Stille erkennen</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="segment_extraction">
                        <span class="step-icon">3</span>
                        <span class="step-label">Segmente extrahieren</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="loading_whisper">
                        <span class="step-icon">4</span>
                        <span class="step-label">Whisper-Modell laden</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="transcription">
                        <span class="step-icon">5</span>
                        <span class="step-label">Transkription</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="grouping">
                        <span class="step-icon">6</span>
                        <span class="step-label">Takes gruppieren</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="ai_evaluation">
                        <span class="step-icon">7</span>
                        <span class="step-label">AI Bewertung (Claude)</span>
                        <span class="step-status"></span>
                    </div>
                    <div class="step" data-step="export">
                        <span class="step-icon">8</span>
                        <span class="step-label">Export generieren</span>
                        <span class="step-status"></span>
                    </div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <div class="processing-stats" id="processing-stats"></div>
            </div>
        </section>

        <!-- ── SCREEN 3: Results ── -->
        <section id="screen-results" class="screen">
            <div class="results-header">
                <h2>Ergebnis</h2>
                <div class="results-summary" id="results-summary"></div>
            </div>

            <div class="export-bar" id="export-bar">
                <button class="btn btn-primary" id="btn-download-xml">FCP XML herunterladen</button>
                <button class="btn btn-secondary" id="btn-download-edl">EDL herunterladen</button>
                <button class="btn btn-ghost" id="btn-download-json">JSON Report</button>
                <button class="btn btn-ghost" id="btn-new">Neue Datei</button>
            </div>

            <div class="ai-notes" id="ai-notes"></div>

            <div class="timeline-container">
                <h3>Timeline</h3>
                <div class="timeline" id="timeline"></div>
            </div>

            <div class="groups-container">
                <h3>Take-Vergleich</h3>
                <div id="groups-list"></div>
            </div>
        </section>

        <!-- ── SCREEN 4: Error ── -->
        <section id="screen-error" class="screen">
            <div class="error-card">
                <h2>Fehler</h2>
                <p id="error-message"></p>
                <button class="btn btn-primary" id="btn-retry">Nochmal versuchen</button>
            </div>
        </section>

    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
